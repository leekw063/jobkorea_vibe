# 잡코리아 채용공고 추출 기능

## 개요

잡코리아 채용공고 페이지에서 상세 정보를 추출하여 Markdown 형식으로 저장합니다.

## 추출되는 정보

### 1. 제목
- 큰 폰트의 span 태그 (18pt, 20pt)
- h1, h2 태그
- 특정 클래스명 (.job-title, .recruit-title 등)

### 2. 모집요강
`<dt>`, `<dd>` 태그에서 추출:
- 모집분야
- 모집인원
- 고용형태
- 급여
- 근무시간
- 근무지
- 경력
- 학력
- 핵심역량

### 3. 주요 섹션
다음 키워드를 기준으로 섹션 분리:
- 주요업무 / 담당업무
- 지원자격 / 자격요건
- 우대사항 / 우대조건
- 이런 분이라면 잘 맞아요
- 채용 프로세스
- 혜택 및 복지
- 근무환경
- 기업정보

## 테스트 방법

### 1. 단독 테스트 스크립트 실행

```bash
cd backend-new
node test-jobkorea-extraction.js [공고번호]
```

예시:
```bash
node test-jobkorea-extraction.js 48060904
```

브라우저가 열리면서 추출 과정을 볼 수 있습니다.

### 2. API를 통한 테스트

```bash
# 서버 시작
npm run dev

# 다른 터미널에서 API 호출
curl http://localhost:4001/api/job-postings/48060904/markdown
```

## 추출 로직 개선 사항

### 이전 문제점
- 제목을 제대로 추출하지 못함
- 모집요강 정보를 건너뜀
- 섹션이 비어있을 때 대체 방법 부족
- 중복 내용이 많음

### 개선 내용
1. **다중 방법으로 제목 추출**: 여러 셀렉터를 순차적으로 시도
2. **모집요강 추가**: `<dt>`, `<dd>` 태그에서 정형화된 정보 추출
3. **더 많은 섹션 키워드**: "담당업무", "자격요건" 등 다양한 표현 지원
4. **중복 제거**: Set을 사용하여 동일한 내용이 반복되지 않도록 함
5. **대체 본문 추출**: 섹션이 비어있을 때 여러 셀렉터로 전체 본문 추출
6. **상세 로그**: 각 단계별 추출 결과를 콘솔에 출력

## 예시 출력

```markdown
# [마크애니] SaaS 플랫폼 시니어 개발자 채용(개발 및 리드역할)

**공고번호:** 48060904

## 모집요강

**모집분야:** SaaS 플랫폼 테크리더 채용

**모집인원:** ○명

**고용형태:** 정규직

**급여:** 회사 내규에 따름 (면접 후 결정)

**근무시간:** 주5일(월~금) 09:00 ~ 18:00

**근무지:** 서울 중구 쌍림동 151-11 쌍림빌딩 13층

**경력:** 경력(8년이상)

**학력:** 대졸이상

**핵심역량:** 계획성, 성실성, 꼼꼼함, 창의성, 성장지향성

## 주요업무

- (추출된 업무 내용)

## 지원자격

- (추출된 자격 내용)

...
```

## 데이터 저장

추출된 공고 정보는 다음과 같이 저장됩니다:

1. **DB 저장** (`job_postings` 테이블):
   - `job_posting_id`: 공고번호
   - `job_posting_title`: 공고 제목
   - `job_detail_md`: Markdown 형식의 상세 정보

2. **이력서 검토 시 활용**:
   - DB에 저장된 Markdown을 불러와 Gemini API에 전달
   - AI가 이력서와 공고를 비교하여 적합도 평가

## 문제 해결

### 정보가 제대로 추출되지 않는 경우

1. **제목이 "제목 없음"으로 나오는 경우**:
   - 테스트 스크립트를 `headless: false`로 실행하여 페이지 구조 확인
   - 실제 페이지의 HTML에서 제목이 어떤 태그/클래스에 있는지 확인
   - `playwrightService.js`의 제목 추출 로직에 해당 셀렉터 추가

2. **섹션이 비어있는 경우**:
   - 로그에서 "섹션 정보 없음" 메시지 확인
   - 전체 본문 추출 셀렉터가 작동하는지 확인
   - 필요시 새로운 셀렉터 추가

3. **중복 내용이 많은 경우**:
   - `processedTexts` Set이 제대로 작동하는지 확인
   - 텍스트 정제 로직(`cleanText`) 개선

## 참고

- 잡코리아 페이지 구조는 수시로 변경될 수 있습니다
- 추출 로직은 주기적으로 업데이트가 필요할 수 있습니다
- 문제 발생 시 테스트 스크립트로 먼저 디버깅하세요

